---
title: "Phase3"
author: "Karla Otoude and Chloé Marquis"
format:
  pdf: default
execute:
  echo: false
  warning: false
  message: false
---

#### Link to our github project 
[Our Github Project](https://github.com/chloemrq/Project-Data-Management)

# I. Research question 
**How are changes in health and social protection expenditures associated with avoidable mortality across OECD countries over time?**

One key factor explaining differences in population health across countries is the strength of social and health protection systems. In particular, investment in healthcare and social protection is expected to reduce mortality from causes that are considered treatable through effective public policies.

This report seeks to understand the relationship between social and health protection spending and avoidable mortality, used as an indicator of the effectiveness of a country's health system. Avoidable mortality captures premature deaths that could be prevented through healthcare, making it a relevant proxy for population health.

Using panel data for 41 OECD countries between 2000 and 2023, this report aims to analyse the global evolution of avoidable mortality across OECD countries and assess if high levels of social and health spending are correlated with lower avoidable mortality rates. A second part focuses on the Covid-19 crisis, to understand if countries with a stronger health protection pre-Covid experienced lower avoidable mortality rates from 2020 to 2021.

## Method 
To conduct our study we will be using a **linear mixed model (LMM)**. Lagged variables will be used as investments in both the social and health systems likely impact the population's general health with a delay. 

For explanatory variables, in order to estimate the strength and quality of a country’s health protection scheme, we will use the following variables: 

* Health expenditure 
* Social expenditure aggregates
* Number of hospitals beds

We also have more general variables such as :

* GDP per capita 
* Unemployment rate 
* Human development index 
* Life expectancy

They will be used as control variables, since richer countries tend to have better living conditions leading to a healthier population.

The explained variable is : 

* Avoidable mortality 

 
```{r}
# Loading the packages
library(here)
here::i_am("Project-Data-Management.Rproj")
```


```{r}
library(ggplot2)
library(dplyr)
library(tidyr)
library(vroom)
library(readxl)
library(lme4)
```

# II. Description of the datasets
This report relies on 8 datasets. More details on the datasets and their descriptive statistics can be found in Phase 2.

#### Health expenditure - OECD (2025)
This dataset details the annual health expenditure and financing as a percentage of GDP for 52 countries (2000-2023). It includes consumption of healthcare goods and services from different health providers.

### Avoidable mortality - OECD (2025)
This dataset describes the number of "avoidable deaths" per 100,000 inhabitants annually for the period 2000-2023 for 46 countries. It contains 2 indicators referring to premature mortality (under age 75) : “preventable mortality” and “treatable mortality”. 

### GDP per Capita - World Bank (2024)
The GDP per capita dataset presents the GDP per capita (constant 2015 US$) from 1960 to 2023 for 70 countries.

### Hospital beds - OECD (2025)
This dataset provides data on the number of total hospitals beds per 1,000 inhabitants by function of healthcare and by type of care (ie. somatic or psychiatric care) for the period 2000-2023 for 48 different countries.

### Life expectancy - World Bank (2023)
This dataset provides the life expectancy in years for women and men for a period ranging from 1960 to 2023, for 69 different countries or economies. 

### Social Expenditure Aggregate - OECD (2025)
This dataset includes statistics on public and private social expenditure at program level (e.g. Old age, Survivors, etc) as a percentage of GDP. It covers 38 OECD countries for the period 1980-2023.

### Unemployement Rate - IMF (2025)
This dataset describes the percentage of the labor force that is unemployed and actively seeking employment. It is available from 1980 to 2025 and features 120 geographic regions. 

### HDI (Human Development Index) - UNDP (2025)
This dataset describes the human development index, per country (195), annually (1990-2023). It is a summary measure of average achievement in 3 dimensions of human development: a long and healthy life, being knowledgeable and having a decent standard of living.


```{r}
# Loading the cleaned dataset from phase 2
database <- vroom(here("data", "cleaned_database.csv"))
```


```{r}
# Loading the raw datasets to create a brief description table
health_expenditure <- vroom(here("data", "OECD.ELS.HD,DSD_SHA@DF_SHA,1.0+.A.EXP_HEALTH.PT_B1GQ._T.._T.._T....csv"))

avoidable_mortality <- vroom(here("data", "OECD.ELS.HD,DSD_HEALTH_STAT@DF_AM,1.1+.A.AVM.DT_10P5HB.._T........csv"))

gdp_per_capita <- vroom(
  here("data/API_NY.GDP.PCAP.KD_DS2_en_csv_v2_242568", "API_NY.GDP.PCAP.KD_DS2_en_csv_v2_242568.csv"),
  delim = ",",
  skip = 4,           # need to skip the first 4 rows
  col_names = TRUE,   
)

hospital_beds <- vroom(here("data", "OECD.ELS.HD,DSD_HEALTH_REAC_HOSP@DF_BEDS_FUNC,1.0+..BD..._T._T...csv"))

life_expectancy <- vroom(
  here("data/API_SP.DYN.LE00.IN_DS2_fr_csv_v2_11258", "API_SP.DYN.LE00.IN_DS2_fr_csv_v2_11258.csv"), 
  delim = ",",
  skip = 4,           # need to skip the first 4 rows
  col_names = TRUE)

social_expenditure <- vroom(here("data","OECD.ELS.SPD,DSD_SOCX_AGG@DF_SOCX_AGG,1.0PT_B1GQ.ES10._T.csv"))

unemployment <- vroom(here("data", "dataset_2025-11-21T14_31_58.442440069Z_DEFAULT_INTEGRATION_IMF.RES_WEO_9.0.0.csv"))

hdi <- read_excel("data/hdr-data.xlsx")
```


```{r}
# Description table 
data_sets <- list(
  list(name = "Health Expenditure", data = health_expenditure),
  list(name = "Avoidable Mortality", data = avoidable_mortality),
  list(name = "GDP per Capita", data = gdp_per_capita),
  list(name = "Number of Hospital Beds", data = hospital_beds),
  list(name = "Life Expectancy", data = life_expectancy),
  list(name = "Social Expenditure", data = social_expenditure),
  list(name = "Unemployement", data = unemployment),
  list(name = "HDI", data = hdi)
)

get_summary <- function(dataset) {
  data <- dataset$data
  dataset_name <- dataset$name

  data.frame(
    Dataset = dataset_name,
    Observations = nrow(data),
    Variables = ncol(data)
  )
}

# Apply to all datasets
summary_list <- lapply(data_sets, get_summary)
summary_table <- do.call(rbind, summary_list)

# Display the table
knitr::kable(summary_table, caption = "Brief summary of the datasets used in this report")
```

## Description of the merged and cleaned dataset 
```{r}
database |> 
  summarise("Number of rows" = n(), 
            "Number of columns" = ncol(database),
            "Percentage of NA" = paste0(round(sum(is.na(database)) / (n() * ncol(database)) * 100, 2), "%"),
            "Number of countries studied" = n_distinct(REF_AREA), 
            "Time period" = paste0(min(TIME_PERIOD), "-", max(TIME_PERIOD))) |> 
  as.data.frame() |>
  knitr::kable()
```


# 3. Data Analysis 
We first start by a visual exploration of our main variable : avoidable mortality (*OBS_VALUE_mortality*) and its link to explanatory variables.

### Evolution of avoidable mortality per country
```{r}
average_trend <- database |>
  group_by(TIME_PERIOD) |>
  summarise(mean_mortality = mean(OBS_VALUE_mortality, na.rm = TRUE))

database |>
  ggplot(aes(x = TIME_PERIOD, y = OBS_VALUE_mortality, color=REF_AREA)) +
  geom_line() +
  geom_line(
    data = average_trend,
    aes(x = TIME_PERIOD, y = mean_mortality, color="OECD average"),
    color = "red",
    linewidth = 1.3
  ) +
  scale_x_continuous(breaks = c(2000, 2010, 2020)) +
  labs(
    x = "Year",
    y = "Number of avoidable deaths",
    caption = "Red line: OECD average",
    title = "Avoidable mortality per country (2000-2023), per 100,000 inhabitants annually")
```
Most countries share the same downward sloping trend in avoidable mortality. A distinct increase appears in 2019, with a peak in 2020 and a decrease to previous trend values from 2021 in all countries. 
The country with the lowest avoidable death rate is Switzerland (CHE) and the highest is Latvia at the beginning of the 2000s, then surpassed by Lithuania (LTU) around 2007. Additionally, there is a strong increase in avoidable deaths from around 400 to almost 650 per 100,000 inhabitants in Mexico in 2019. 

### Visualising *avoidable_mortality* against independent variables
We can start the data analysis by simply plotting some independent variables against *avoidable_mortality* and observe the general trend. 

```{r}
ggplot(database, aes(x = OBS_VALUE_health_exp, y = OBS_VALUE_mortality)) +
  geom_point(aes(color = REF_AREA)) +
  theme(legend.position = "right") +
  labs(
    x = "Health expenditure (as % of GDP)", 
    y = "Avoidable mortality",
    title = "Avoidable mortality against Health expenditure") +
  geom_smooth(method = "lm", se = FALSE) 
```

As expected, as the level of health expenditure increases, avoidable mortality tends to decrease. Australia (AUS) detaches itself from other countries by having a particularly high level of health expenditure, but still a moderately high level of avoidable mortality. Most countries are situated on the left side of the graph (with low health expenditure) showcasing countries with high and low rates of avoidable mortality for the same level of health expenditure. 

```{r}
ggplot(database, aes(x = OBS_VALUE_social_expenditure, y = OBS_VALUE_mortality)) +
  geom_point(aes(color = REF_AREA)) +
  theme(legend.position = "none") +
  labs(
    x = "Social expenditure (as % of GDP)", 
    y = "Avoidable mortality",
    title = "Avoidable mortality against Social Expenditure") +
  geom_smooth(method = "lm", se = FALSE)
```

As social expenditure increases, the avoidable mortality rate decreases. Most countries' social expenditure is within 10% and 25% of their GDP. However, for these countries similar in social expenditure levels, avoidable mortality goes from 100 to almost 700 per 100,000 deaths, suggesting an important variability. For similar levels of health or social expenditure, avoidable mortality varies significantly between countries.


```{r}
ggplot(database, aes(x = OBS_VALUE_unemp, y = OBS_VALUE_mortality)) +
  geom_point(aes(color = REF_AREA)) +
  theme(legend.position = "none") +
  labs(    
    x = "Unemployement", 
    y = "Avoidable mortality",
    title = "Avoidable mortality against Unemployment") +
  geom_smooth(method = "lm", se = FALSE)
```
Here, the trend indicates that as unemployment increases, avoidable mortality does too. Most countries have low levels of unemployment and low rates of avoidable mortality. 
In the bottom right, Spain (ESP) and Greece (GRC) display very high rates of unemployment while keeping their avoidable mortality rates among the lowest of all countries. On the contrary, countries such as Mexico (MEX) in purple showcase high levels of avoidable mortality with very low rates of unemployment. 

```{r}
ggplot(database, aes(x = OBS_VALUE_gdp, y = OBS_VALUE_mortality)) +
  geom_point(aes(color = REF_AREA)) +
  theme(legend.position = "none") +
  labs(
    x = "GDP per Capita", 
    y = "Avoidable mortality",
    title = "Avoidable mortality against GDP per Capita") +
  geom_smooth(method = "lm", se = FALSE)
```
This graph suggests that as GDP per capita increases, the rate of avoidable mortality decreases. The avoidable mortality rate doesn't go below 100 deaths per 100,000 inhabitants. Thus, as GDP per capita increases, avoidable mortality remains between 100 and 300 deaths per 100,000 inhabitants suggesting marginal change in mortality as a country's population becomes richer.


# 4. Econometric Analysis : Linear Mixed Model (LMM)

## Correlation matrix for control variables 
```{r}
control_vars <- database |>
  select(OBS_VALUE_mortality, OBS_VALUE_gdp, OBS_VALUE_hdi, OBS_VALUE_life_exp, OBS_VALUE_unemp)

cor(control_vars) |>
  knitr::kable()
```
The correlation matrix reveals strong linear relationships among several control variables. 

* Avoidable mortality is highly negatively correlated with life expectancy (-0.96), reflecting the fact that both variables capture very similar aspects of general population health. 
* Life expectancy is also strongly correlated with HDI (0.76) and GDP per capita (0.65), meaning there is an overlap between these variables. 

To avoid multicollinearity issues in regression models, we choose to exclude HDI and life expectancy from our control variables. We retain GDP per capita and unemployment, which can adjust for differences in economic development between countries.


## Creating lag operators/ lagged variables

```{r}
data_lagged <- database |>
  group_by(REF_AREA) |>
  arrange(TIME_PERIOD) |>
  mutate(
    mortality_lag1 = lag(OBS_VALUE_mortality, 1),
    
    healthExp_lag1 = lag(OBS_VALUE_health_exp, 1),
    
    healthExp_ma3 = (lag(OBS_VALUE_health_exp, 1) +
                     lag(OBS_VALUE_health_exp, 2) +
                     lag(OBS_VALUE_health_exp, 3)) / 3,
    
    healthExp_ma5 = (lag(OBS_VALUE_health_exp, 1) +
                     lag(OBS_VALUE_health_exp, 2) +
                     lag(OBS_VALUE_health_exp, 3) +
                     lag(OBS_VALUE_health_exp, 4) +
                     lag(OBS_VALUE_health_exp, 5)) / 5,
    
    hospBeds_lag1 = lag(OBS_VALUE_hosp_beds, 1),
    
    hospBeds_ma3 = (lag(OBS_VALUE_hosp_beds, 1) +
                     lag(OBS_VALUE_hosp_beds, 2) +
                     lag(OBS_VALUE_hosp_beds, 3)) / 3,
    
    hospBeds_ma5 = (lag(OBS_VALUE_hosp_beds, 1) +
                     lag(OBS_VALUE_hosp_beds, 2) +
                     lag(OBS_VALUE_hosp_beds, 3) +
                     lag(OBS_VALUE_hosp_beds, 4) +
                     lag(OBS_VALUE_hosp_beds, 5)) / 5,
    
    socialExp_lag1 = lag(OBS_VALUE_social_expenditure, 1),

    socialExp_ma3 = (lag(OBS_VALUE_social_expenditure, 1) +
                     lag(OBS_VALUE_social_expenditure, 2) +
                     lag(OBS_VALUE_social_expenditure, 3)) / 3, 
    
    socialExp_ma5 = (lag(OBS_VALUE_social_expenditure, 1) +
                     lag(OBS_VALUE_social_expenditure, 2) +
                     lag(OBS_VALUE_social_expenditure, 3) +
                     lag(OBS_VALUE_social_expenditure, 4) +
                     lag(OBS_VALUE_social_expenditure, 5)) / 5
  ) |>
  ungroup()
```

Before further modelling, we create lagged version of our variables. We believe that past investments in the health sector and social protection have an impact on mortality. We use 1-year lads to study short-term effects. 3-year and 5-year moving averages will be used to capture long-term investments. Indeed, we assume increased hospital capacities or training staff takes a few years before benefiting the health system. 

- `mortality_lag1` : 1-year lag of avoidable mortality 
- `healthExp_lag1` : 1-year lag of health expenditure (short-run)
- `healthExp_ma3` : 3-year average lag of health expenditure (medium-run)
- `healthExp_ma5` : 5-year average lag of health expenditure (long-run)
- `hospBeds_lag1` : 1-year lag of hospital beds 
- `hospBeds_ma3` : 3-year average lag of hospital beds
- `hospBeds_ma5` : 5-year average lag of hospital beds
- `socialExp_lag1` : 1-year lag of social expenditure
- `socialExp_ma3` : 3-year average lag of social expenditure
- `socialExp_ma5` : 5-year average lag of social expenditure

## Model testing

### First test using multiple lags

We do a first test to see how our variables interact with each other, especially lags

\begin{equation*}
\begin{aligned}
Mortality_{i,t} =\;& \gamma_{0,i}
+ u_{i}
+ \beta_{1} \, mortality_{i,t-1}
+ \beta_{2} \, health.expenditure_{i,t-1}
+ \beta_{3} \, health.expenditure_{i,t-[1,5]} \\[0.4em]
&+ \beta_{4} \, hospital.beds_{i,t-1}
+ \beta_{5} \, hospital.beds_{i,t-[1,5]} 
+ \beta_{6} \, social.expenditure_{i,t-1} \\[0.4em]
&+ \beta_{7} \, social.expenditure_{i,t-[1,5]}
+\beta_{8} \, GDP.per.capita_{i,t}
+ \beta_{9} \, Unemployment_{i,t} \\[0.4em]
&+ \epsilon_{i,t}
\end{aligned}
\end{equation*}

With

\begin{itemize}
\item $i$, index for country i
\item $t$, index for period t (here our periods are years)
\item $\epsilon_{i,t}$, the idiosyncratic error term
\item $u_i$, a country-specific random intercept
\item $\gamma_0$ is the overall mean intercept
\end{itemize}

All explanatory variables enter the model as fixed effects, while unobserved country-level heterogeneity is captured through a random intercept `\u_{i}`. GDP per capita and unemployment are included as control variables accounting for differences in economic conditions across countries and over time.

**Summary of the first regression :**
```{r}
first_test <- lmer(OBS_VALUE_mortality ~ mortality_lag1 + healthExp_lag1 + healthExp_ma5 + hospBeds_lag1 + hospBeds_ma5 + socialExp_lag1 + socialExp_ma5 + OBS_VALUE_gdp + OBS_VALUE_unemp + ( 1 | REF_AREA), 
                   control = lmerControl(autoscale = TRUE), # added after R warned some variables are on different scales 
                   data = data_lagged, 
                   REML = FALSE)
```
In the regression summary, `REF_AREA (Intercept)`denotes the country-level random intercept. 


After this first test, we notice 3 problems : 

1. The correlation between `mortality_lag1` and the intercept is very high (-0.729), nullifying the effect of the random intercept (variance and standard deviation equal to 0). This shows that past mortality already explains most differences between countries. We decide to remove `mortality_lag1` from the next regressions.
2. Using both the first lag and the long-run moving average of variables in the same model is not possible. The correlation between the two makes it hard to distinguish which has an effect on mortality and the long-run moving average of explanatory variables end up having incoherent coefficients. 
3. There is an issue with the large difference in scale between the variables and `OBS_VALUE_gdp`. Indeed, it is expressed in constant 2015 US$ while other variables are expressed in % of GDP or unit per 1,000 or 100,000. We choose to rescale it in further regressions as `OBS_VALUE_gdp = OBS_VALUE_gdp / 1000`

```{r}
# rescaling the GDP per capita variable 
data_lagged$OBS_VALUE_gdp <- data_lagged$OBS_VALUE_gdp / 1000
```


In addition, we decide to add 2 variables as random effects : social expenditure and health expenditure. This will allow us to better perceive the differences between countries when it comes to social and health policies.  
The last explanatory variable, the number of hospital beds will not be added as a random effect since we noticed through testing that it does not have a causal effect on avoidable mortality. Moreover we fear it would clash with the health expenditure variable as they are heavily linked.  


We will compare short-run, medium-run and long-run in 3 different models 

### Models for the short-run, medium-run and long-run

*Short-run model :* 

\begin{equation*}
\begin{aligned}
Mortality_{i,t} =\;& \gamma_{0,i}
+ u_{i}
+ \gamma_{1} \, health.expenditure_{i,t-1}
+ \beta_{2} \, hospital.beds_{i,t-1}
+ \gamma_{3} \, social.expenditure_{i,t-1} \\[0.4em]
&+\beta_{4} \, GDP.per.capita_{i,t}
+ \beta_{5} \, Unemployment_{i,t}
&+ \epsilon_{i,t}
\end{aligned}
\end{equation*}


**Summary of the short-run regression :**
```{r}
model_short_run <- lmer(OBS_VALUE_mortality ~ healthExp_lag1 + hospBeds_lag1 + socialExp_lag1 + OBS_VALUE_gdp + OBS_VALUE_unemp + (1 | REF_AREA) +
    (0 + healthExp_lag1 | REF_AREA) +
    (0 + socialExp_lag1 | REF_AREA), 
                   control = lmerControl(autoscale = TRUE),
                   data = data_lagged, 
                   REML = FALSE)
print(summary(model_short_run), correlation = TRUE)
```

*Interpretation of the results* 

Firstly, the variance of the random intercept `REF_AREA (Intercept)` is 35369.29, which is much higher than the residual variance (`Residual`) at 808.14. The large random intercept variance indicates substantial between-country differences in baseline avoidable mortality.
The standard deviation is 188.07, suggesting a deviation of about 188 deaths per 100,000 between countries. 


Second, we will interpret each coefficient : 
( if |t| > 1.96 (for \alpha = 5%), the coefficient is statistically significant)

All coefficients are all statistically significant except `OBS_VALUE_unemp` (t = 0.93)

- `Intercept` : The baseline number of avoidable deaths per 100,000 when all other predictors are 0 is 322.03.
- `healthExp_lag1` : An increase in health expenditure by 1% of GDP last year is associated with 17 fewer deaths per 100,000. There is a deviation of 30 deaths between countries (`Std.Dev.`).
- `hospBeds_lag1` : The addition of 1 bed per 1,000 inhabitants last year is associated with 29 more deaths per 100,000. This could be a sign that countries with higher mortality happen to invest more in hospital beds.
- `socialExp_lag1`: The increase in social expenditure by 1% of GDP last year is associated with around 4 fewer deaths per 100,000 this year. There is a deviation of 8 deaths between countries (`Std.Dev.`).
- `OBS_VALUE_gdp` : An increase in GDP by 1,000 USD reduces avoidable mortality by 4.33 deaths per 100,000.
- `OBS_VALUE_unemp` : increase in unemployment by 1% of GDP is associated with 0.53 less deaths per 100,000. It is a surprising result but this variable is not statistically significant here.

In conclusion, increases in social and particularly health expenditure reduce the avoidable mortality rate in the short-term and as expected, GDP reduces mortality. 
Moreover there are huge differences in health and social investments between countries, although it is less the case for social investments. 


*Medium-run model : *

\begin{equation*}
\begin{aligned}
Mortality_{i,t} =\;& \gamma_{0,i}
+ u_{i}
+ \gamma_{1} \, health.expenditure_{i,t-[1,3]}
+ \beta_{2} \, hospital.beds_{i,t-[1,3]}
+ \gamma_{3} \, social.expenditure_{i,t-[1,3]} \\[0.4em]
&+\beta_{4} \, GDP.per.capita_{i,t}
+ \beta_{5} \, Unemployment_{i,t}
&+ \epsilon_{i,t}
\end{aligned}
\end{equation*}

**Summary of the medium-run regression :**
```{r}
model_medium_run <- lmer(OBS_VALUE_mortality ~ healthExp_ma3 + hospBeds_ma3 + socialExp_ma3 + OBS_VALUE_gdp + OBS_VALUE_unemp + (1 | REF_AREA) +
    (0 + healthExp_ma3 | REF_AREA) +
    (0 + socialExp_ma3 | REF_AREA), 
                   control = lmerControl(autoscale = TRUE),
                   data = data_lagged, 
                   REML = FALSE)
summary(model_medium_run)
```
*Interpretation of the results* 
First, the variance of the random intercept is still much higher than the residual variance (34118.23 against 785.21). The standard deviation is 184.71, suggesting a deviation of about 184 deaths per 100,000 between countries. This is similar to the short-run results.

Second, all coefficients are all statistically significant except for `OBS_VALUE_unemp` (t = 0.810) and `socialExp_ma3` (t = 0.889). 

- Intercept : The baseline number of avoidable deaths per 100,000 when all other predictors are 0 is 341.9.
- `healthExp_ma3` : An increase in health expenditure by 1% of GDP over the past 3 years is associated with 17.66 fewer deaths per 100,000. There is a deviation of 28 deaths between countries (`Std.Dev.`).
- `hospBeds_ma3` : The addition of 1 bed per 1,000 inhabitants over the past 3 years is associated with an increase of deaths per 100,000 by 27.57.
- `socialExp_ma3`: The increase in social expenditure by 1% of GDP over the past 3 years is associated with 1.75 more deaths per 100,000 this year. Given the fact this variable is no longer significant, we can assume the model fails to capture the actual effect of social expenditure on mortality. There is a deviation of 7 deaths between countries (`Std.Dev.`).
- `OBS_VALUE_gdp` : An increase in GDP by 1,000 USD reduces avoidable mortality by  3.37 deaths per 100,000.
- `OBS_VALUE_unemp` : increase in unemployment by 1% of GDP is associated with 0.49 less deaths per 100,000.

Third, the AIC is 6970.0 (lower than for the short-run), indicating better fit for medium-run effects.

In conclusion, health expenditure reduces mortality over 3 years, suggesting that the effects accumulate. Social expenditure is no longer significant. Unexpectedly, there is a positive association between the number of hospital beds and the avoidable mortality rate.  
GDP continues to reduce mortality (medium-run effects are slightly smaller than the short-run ones). Moreover, the unemployment effect is much bigger in the medium-run than in the short run with an increase to 9 deaths compared to 1 previously. 
We still see huge deviations from one country to another in health and social expenditure (although slightly lower).

*Long-run model : *

\begin{equation*}
\begin{aligned}
Mortality_{i,t} =\;& \gamma_{0,i}
+ u_{i}
+ \gamma_{1} \, health.expenditure_{i,t-[1,5]}
+ \beta_{2} \, hospital.beds_{i,t-[1,5]}
+ \gamma_{3} \, social.expenditure_{i,t-[1,5]} \\[0.4em]
&+\beta_{4} \, GDP.per.capita_{i,t}
+ \beta_{5} \, Unemployment_{i,t}
&+ \epsilon_{i,t}
\end{aligned}
\end{equation*}

**Summary of the long-run regression :**
```{r} 
model_long_run <- lmer(OBS_VALUE_mortality ~ healthExp_ma5 + hospBeds_ma5 + socialExp_ma5 + OBS_VALUE_gdp + OBS_VALUE_unemp + (1 | REF_AREA) + (0 + healthExp_ma5 | REF_AREA) + (0 + socialExp_ma5 | REF_AREA),
    control = lmerControl(autoscale = TRUE), 
                   data = data_lagged, 
                   REML = FALSE)
summary(model_long_run)
```
*Interpretation of the results*
First, the variance of the random intercept is still higher than the residual variance (33616.43 against 776.99). There is deviation of about 183 deaths per 100,000 between countries. It is smaller than it was in the medium-run model even though the standard deviation remains more or less the same in the 3 models.

Second, all coefficients are all statistically significant except for `OBS_VALUE_unemp` (t = 0.408) and `socialExp_ma5` (t = 0.183)

- Intercept : The baseline number of avoidable deaths per 100,000 when all other predictors are 0 is 332.
- `healthExp_ma5` : An increase in health expenditure by 1% of GDP over the past 5 years is associated with 13.40 fewer deaths per 100,000. There is a deviation of 24 deaths between countries (`Std.Dev.`).
- `hospBeds_ma5` : The addition of 1 bed per 1,000 inhabitants over the past 5 years is associated with an increase of deaths per 100,000 by 26.63.
- `socialExp_ma5`: The increase in social expenditure by 1% of GDP over the past 5 years is associated with 0.42 fewer deaths per 100,000 this year. It is a small number but once again this can be explained by the fact that this variable is no longer significant. There is a deviation of 8 deaths between countries (`Std.Dev.`). 
- `OBS_VALUE_gdp` : An increase in GDP by 1,000 USD reduces avoidable mortality by  2.81 deaths per 100,000.
- `OBS_VALUE_unemp` : increase in unemployment by 1% of GDP is associated with 0.50 less deaths per 100,000.

Third, the AIC is 6120 (lower than for the short-run and medium-run models), indicating better fit for long-run effects.
We see more or less the same deviations between countries in health and social expenditure as before. 



### Conclusion comparing short-medium-long run models

In the short-run, we can interpret the impact of health and social expenditure on avoidable mortality as an immediate budgetary effect. Having a new monetary flow each year in the health sector is important to face urgent needs or crisis. Health expenditure reduces mortality most strongly in the short run (-17.42 deaths per 100,000). However, the number of hospital beds and social expenditure showcase a positive impact on mortality.

Over a 3-year horizon, cumulative government spending begins to show efficiency: health expenditure reduces mortality by -17.66, hospital beds still show a positive association with mortality (+27.57). This could reflect important investments in the number of beds per 1,000 inhabitants rather than a causal effect on mortality. This highlights that medium-run effects are partly shaped by policy planning and investment patterns, rather than short-run decisions. 

In the long-run, the impact of health expenditure  and the number of hospital beds can be interpreted as a structural effect. Health expenditure reduces deaths by -13.40 over five years, showing a persistent effect, although slightly smaller than medium-run averages for health expenditure. Hospital beds remain positively associated with mortality (+26.63). GDP consistently reduces mortality across all horizons.

Finally in all 3 models we notice huge deviations between countries when it comes to health and social expenditure (25-30 deaths for health expenditure and ~8 deaths for social expenditure). There is a lot of heterogeneity between countries which we could interpret as differences in institutional quality or past health and social protection history. 



### Comparing short-run, medium run and long-run

*Looking at the AIC : *

- For the short-run model : 7858.5
- For the medium-run model : 6970.0
- For the long-run model : 6120

The AIC - Akaike information criterion - is a measure for how well fitted a model is. The AIC verifies both if explanatory variables explain the observed variable correctly. 

The lower the AIC is, the better the model is. Here, the long-run model has the lowest AIC.
Considering all 3 models have the same number of parameters, a lower AIC means avoidable mortality is better explained by the long-run model. 

### Testing for the Covid-19 period

We perform regressions using lags and the Covid-19 dummy variable. Moreover, in order to clearly see the impact of previous investment on avoidable mortality during the Covid-19 crisis, we create interaction variables using our lags. 

We note that using interaction terms for time t could lead to reverse causality problems. We might be unable to identify whether health expenditure, social expenditure and hospital beds impacted avoidable mortality or if because mortality increased suddenly during the pandemic, health expenditure, social expenditure and hospital beds were increased afterwards. 
```{r}
data_lagged <- data_lagged |>
  mutate(
    pandemic = ifelse(TIME_PERIOD %in% c(2020:2021), 1, 0)
  )

data_lagged <- data_lagged |>
  mutate(
    healthexp_pandemic_lag1 = healthExp_lag1 * pandemic,
    healthexp_pandemic_ma3 = healthExp_ma3 * pandemic,
    healthexp_pandemic_ma5 = healthExp_ma5 * pandemic,
    socialexp_pandemic_lag1 = socialExp_lag1 * pandemic,
    socialexp_pandemic_ma3 = socialExp_ma3 * pandemic,
    socialexp_pandemic_ma5 = socialExp_ma5 * pandemic
  )
```

- `healthexp_pandemic_lag1` = interaction term between the `pandemic` dummy variable and `healthExp_lag1`
- `healthexp_pandemic_ma3` = interaction term between the `pandemic` dummy variable and `healthExp_ma3`
- `healthexp_pandemic_ma5` = interaction term between the `pandemic` dummy variable and `healthExp_ma5`
- `socialexp_pandemic_lag1` = interaction term between the `pandemic` dummy variable and `socialExp_lag1`
- `socialexp_pandemic_ma3` = interaction term between the `pandemic` dummy variable and `socialExp_ma3`
- `socialexp_pandemic_ma5` = interaction term between the `pandemic` dummy variable and `socialExp_ma5`

The following variables will be interpreted as : 

- `(Intercept)`, baseline avoidable mortality per 100,000 when all other variables are 0, outside of the pandemic
- `pandemic`, average change in mortality due to COVID (years 2020–2021), all else equal
- `healthexp_pandemic_lag1` and `socialexp_pandemic_lag1`, how the effect of pre-pandemic health/social spending changes during the pandemic


*In the short-run :* 

\begin{equation*}
\begin{aligned}
Mortality_{i,t} =\;& \gamma_{0,i}
+ u_{i}
+ \beta_{1} \, health.expenditure_{i,t-1}
+ \beta_{2} \, hospital.beds_{i,t-1}
+ \beta_{3} \, social.expenditure_{i,t-1} \\[0.4em]
&+ \beta_{4} \, pandemic
+ \beta_{5} \, hospital.beds_{i,t-1} * pandemic
+ \beta_{6} \, social.expenditure_{i,t-1} * pandemic \\[0.4em]
&+ \beta_{7} \, GDP.per.capita_{i,t} 
+ \beta_{8} \, Unemployment_{i,t}
&+ \epsilon{i,t}
\end{aligned}
\end{equation*}

**Summary of the short-run regression :**
```{r}
model_covid_short_run <- lmer(OBS_VALUE_mortality ~ hospBeds_lag1 + healthExp_lag1 + socialExp_lag1 + pandemic + healthexp_pandemic_lag1 + socialexp_pandemic_lag1 + OBS_VALUE_gdp + OBS_VALUE_unemp + (1 | REF_AREA) + (0 + healthExp_lag1 | REF_AREA) + (0 + socialExp_lag1 | REF_AREA),
                   control = lmerControl(autoscale = TRUE), 
                   data = data_lagged, 
                   REML = FALSE)
summary(model_covid_short_run)
```
In order to interpret our results we need to sum the coefficient obtained for the health expenditure variable (`healthExp_lag1`) and the interaction term `healthexp_pandemic_lag1`. Same thing for the social expenditure variable. This will tell us how the pandemic impacts the effect of health expenditure and social expenditure on avoidable mortality. 

```{r}
s <- fixef(model_covid_short_run)

# Health expenditure during Covid
s["healthExp_lag1"] + s["healthexp_pandemic_lag1"]

# Social expenditure during Covid
s["socialExp_lag1"] + s["socialexp_pandemic_lag1"]
```
**Interpretation of the results**
First, we analyse the random effects. 

- `REF_AREA (Intercept)` has a variance of 36840.87, meaning there are large differences between countries in baseline avoidable mortality (around 191 deaths per 100,000)
- `REF_AREA.1 healthExp_lag1` has a variance of 986.66. The effect of health expenditure varies between countries by approximately 31 deaths (given by the standard deviation)
- `REF_AREA.2 socialExp_lag1`has a variance of 57.39. The effect of social expenditure is less important. It varies by around 8 deaths per 100,000. 

This suggests that different countries respond differently to health and social expenditures.

Second, we analyse the fixed effects. All variables are significant except `socialExp_lag1`, `healthexp_pandemic_lag1` and `OBS_VALUE_unemp`. 

- `(Intercept)` : The baseline number of avoidable deaths per 100,000 if all other variables are null, outside of the pandemic, is 342.90
- `hospBeds_lag1` : Here, we find similar results as in the previous section : adding 1 hospital bed per 1,000 increases short-run mortality by 32.6 deaths.
- `healthExp_lag1` : A 1% of GDP increase in health expenditure last year reduces mortality by 17.3 deaths per 100,000, outside of the pandemic
- `socialExp_lag1`: A 1% of GDP increase in health expenditure last year increases mortality by 2.84 deaths per 100,000, outside of the pandemic. However, this variable is not statistically significant. 
- `pandemic` : Covid increases baseline mortality by 111 deaths per 100,000, regardless of spending.
- `healthexp_pandemic_lag1` : We combine `healthexp_pandemic_lag1` with `healthExp_lag1` to appreciate the total effect of health expenditure. Its effect is reduced by 0.29 during Covid, -17.006 deaths in total. The effect is still strong. 
- `socialexp_pandemic_lag1` : Outside of the pandemic, social expenditure increases deaths by 2.8382 and decreases it by -0.736 during. In total the effect is slightly negative, thereby having a much smaller impact on mortality compared to health expenditure.

In conclusion, the pandemic increases the number of avoidable deaths sharply. Health expenditure in the short term remains strongly efficient, but this is not the case for social expenditure which has a much smaller effect. Moreover, random intercepts and slopes show important differences between countries. 


*In the medium-run :*

\begin{equation*}
\begin{aligned}
Mortality_{i,t} =\;& \gamma_{0,i}
+ u_{i}
+ \beta_{1} \, health.expenditure_{i,t-[1,3]}
+ \beta_{2} \, hospital.beds_{i,t-[1,3]}
+ \beta_{3} \, social.expenditure_{i,t-[1,3]} \\[0.4em]
&+ \beta_{4} \, pandemic
+ \beta_{5} \, hospital.beds_{i,t-[1,3]} * pandemic
+ \beta_{6} \, social.expenditure_{i,t-[1,3]} * pandemic \\[0.4em]
&+ \beta_{7} \, GDP.per.capita_{i,t} 
+ \beta_{8} \, Unemployment_{i,t}
&+ \epsilon_{i,t}
\end{aligned}
\end{equation*}

**Summary of the medium-run regression :**
```{r}
model_covid_medium_run <- lmer(OBS_VALUE_mortality ~ hospBeds_ma3 + healthExp_ma3 + socialExp_ma3 + pandemic + healthexp_pandemic_ma3 + socialexp_pandemic_ma3 + OBS_VALUE_gdp + OBS_VALUE_unemp + (1 | REF_AREA) + (0 + healthExp_ma3 | REF_AREA) + (0 + socialExp_ma5 | REF_AREA), 
                   control = lmerControl(autoscale = TRUE), 
                   data = data_lagged, 
                   REML = FALSE)
summary(model_covid_medium_run)
```
Here, if we sum coefficients and interaction terms we have : 
```{r}
m <- fixef(model_covid_medium_run)

# Health expenditure
m["healthExp_ma3"] + m["healthexp_pandemic_ma3"]

# Social expenditure
m["socialExp_ma3"] + m["socialexp_pandemic_ma3"]
```
**Interpretation of the results**
We notice that this model seems to have the same trends as the short-run model.

First, we analyse the random effects. 

- `REF_AREA (Intercept)` has a variance of 44455.95, meaning there are large differences between countries in baseline avoidable mortality, more than in the short-run (around 210 deaths per 100,000)
- `REF_AREA.1 healthExp_lag1` has a variance of 753.23. The effect of health expenditure varies between countries by approximately 27 deaths (given by the standard deviation) which is slightly less than in the short-run (about 31 deaths).
- `REF_AREA.2 socialExp_lag1`has a variance of 88.41. The effect of social expenditure is less important. It varies by around 9 deaths per 100,000. 


Second, we analyse the fixed effects. All variables are significant except `healthexp_pandemic_ma3` and `OBS_VALUE_unemp`. 

- `(Intercept)` : The baseline number of avoidable deaths per 100,000 if all other variables are null, outside of the pandemic, is 312.6.
- `hospBeds_ma3` : Here, we find similar results as in the previous section and the short-run regression : adding 1 hospital bed per 1,000 increases short-run mortality by 20.3 deaths, slightly more than in the short-run (17.3)
- `healthExp_ma3` : A 1% of GDP increase in health expenditure last year reduces mortality by 17.3 deaths per 100,000, outside of the pandemic
- `socialExp_ma3`: A 1% of GDP increase in health expenditure last year increases mortality by 5.6 deaths per 100,000, outside of the pandemic.
- `pandemic` : Covid increases baseline mortality by 127 deaths per 100,000, regardless of spending.
- `healthexp_pandemic_ma3` : The effect of health expenditure is reduced by 0.13 during Covid, -20.2 deaths in total. The effect is barely impacted by the Covid period. 
- `socialexp_pandemic_ma3` : The effect of social expenditure is reduced by 4.53 during Covid, increasing deaths by 1.07 in total. In sum, the effect is still positive, suggesting a positive correlation between avoidable mortality and social expenditure.

In conclusion, health expenditure in the medium-term remains strong. This highlights the importance of sustained health spending, which shows positive effects on avoiding deaths druing crises. However, this is not the case for social expenditure which has a positive impact on mortality. This may suggest that countries with higher mortality simultaneously increased social spending in response to Covid. the interaction terms show that the pandemic slightly moderates the impact of health and social expenditures, but the main trends remain similar. Moreover, random intercepts and slopes show even more important differences between countries than in the short-term. 

*In the long-run : *

\begin{equation*}
\begin{aligned}
Mortality_{i,t} =\;& \gamma_{0,i}
+ u_{i}
+ \beta_{1} \, health.expenditure_{i,t-[1,5]}
+ \beta_{2} \, hospital.beds_{i,t-[1,5]}
+ \beta_{3} \, social.expenditure_{i,t-[1,5]} \\[0.4em]
&+ \beta_{4} \, pandemic
+ \beta_{5} \, hospital.beds_{i,t-[1,5]} * pandemic
+ \beta_{6} \, social.expenditure_{i,t-[1,5]} * pandemic \\[0.4em]
&+ \beta_{7} \, GDP.per.capita_{i,t} 
+ \beta_{8} \, Unemployment_{i,t}
&+ \epsilon{i,t}
\end{aligned}
\end{equation*}

**Summary of the long-run regression :**
```{r}
model_covid_long_run <- lmer(OBS_VALUE_mortality ~ hospBeds_ma5 + healthExp_ma5 + socialExp_ma5 + pandemic + healthexp_pandemic_ma5 + socialexp_pandemic_ma5 + OBS_VALUE_gdp + OBS_VALUE_unemp + (1 | REF_AREA) + (0 + healthExp_ma3 | REF_AREA) + (0 + socialExp_ma5 | REF_AREA), 
                   control = lmerControl(autoscale = TRUE), 
                   data = data_lagged, 
                   REML = FALSE)
summary(model_covid_long_run)
```

Then, if we sum coefficients and interaction terms we have : 
```{r}
l <- fixef(model_covid_long_run)

# Health expenditure
l["healthExp_ma5"] + l["healthexp_pandemic_ma5"]

# Social expenditure
l["socialExp_ma5"] + l["socialexp_pandemic_ma5"]
```
**Interpretation of the results**

First, we analyse the random effects. 

- `REF_AREA (Intercept)` has a variance of 36499.9, meaning there are large differences between countries in baseline avoidable mortality, less than in the short- and medium-run (around 191 deaths per 100,000)
- `REF_AREA.1 healthExp_lag1` has a variance of 618.3 The effect of health expenditure varies between countries by approximately 25 deaths (given by the standard deviation) which is slightly less than in the short- and medium-run.
- `REF_AREA.2 socialExp_lag1`has a variance of 62.5 The effect of social expenditure is less important. It varies by around 8 deaths per 100,000. 


Second, we analyse the fixed effects. Some variables are not significant : `socialExp_ma5`, `healthexp_pandemic_ma5` and `OBS_VALUE_unemp`. 

- `(Intercept)` : The baseline number of avoidable deaths per 100,000 if all other variables are null, outside of the pandemic, is 347.3.
- `hospBeds_ma3` : Here, we find similar results as in the previous section and the short-run regression : adding 1 hospital bed per 1,000 increases short-run mortality by 30.1 deaths, more than in the short- and medium-run.
- `healthExp_ma3` : A 1% of GDP increase in health expenditure last year reduces mortality by 17.6 deaths per 100,000, outside of the pandemic
- `socialExp_ma3`: A 1% of GDP increase in health expenditure last year increases mortality by 0.21 deaths per 100,000, outside of the pandemic. But this variable is not significant. 
- `pandemic` : Covid increases baseline mortality by about 124 deaths per 100,000, regardless of spending.
- `healthexp_pandemic_ma3` : The effect of health expenditure is reduced by 0.24 during Covid, -17.4 deaths in total. The effect is, again, barely impacted by the Covid period. 
- `socialexp_pandemic_ma3` : The effect of social expenditure is reduced by 4.4 during Covid, decreasing deaths by 4.6 in total. This time, social expenditure is negative, suggesting that its effects are more latent and decrease the avoidable mortality rate in the long-run.

In conclusion, in the long-run, health expenditure remains the most important factor in reducing avoidable mortality. Social expenditure, which showed positive correlations with avoidable mortality in the short- and medium-run now shows a slight negative effect. This might suggest, social expenditure might take longer to have a concrete impact. Random effects indicate that country-level differences remain important, though slightly smaller than in shorter-term models. Overall, one key finding of our analysis is that sustained health investment is important for reducing avoidable deaths, while social spending contributes more gradually, with long-term benefits appearing later.

Moreover, we compare the 3 model's AIC to determine which fits best the data. 

- short-run AIC : 7729.8
- medium-run AIC: 6130.4
- long-run AIC: 5974.4

As in the previous section, the long-run model best fits the data.



# 5. Conclusion 

Our research stemmed from wondering whether having a strong health and social policy proved useful in order to have a healthy population. The results seem to confirm our intuition. 

Using a linear mixed model allowed us to capture the heterogeneity between countries. It was also key when taking into account the nature of avoidable mortality, which has a very slow evolution, meaning that for most countries the current value of avoidable mortality would be really close to its previous values. In addition a mixed model was also essential since we wanted to account for differences in social and health policies.
We have shown using regression analysis that there is significant variability in avoidable mortality both during and outside of crises between countries. However this aspect would require further modelling to determine which countries/health systems are more impacted by crises and tailor policy responses accordingly. 

Our main conclusions are that increases in health spending are by far the most important element of reducing avoidable mortality while social expenditure is not as important as we could have thought at the beginning of the analysis.
Furthermore according to our model, during the pandemic - which we consider as the years 2020 and 2021 - health expenditure cushioned the increase in avoidable deaths, while social protection was particularly efficient as the population faces difficulties. 

It is important to mention that our analysis is limited in many ways. First of all the number of countries studied is still relatively small (41 OECD countries). Then, we could not explore further the structural differences between countries or other potential variables. In spite of these limitations this report can be considered as a first clue in finding how to reduce avoidable mortality.  

