---
title: "Phase3"
author: "Karla Otoude and Chloé Marquis"
format:
  pdf: default
execute:
  echo: false
  warning: false
  message: false
---

#### Link to our github project 
[Our Github Project](https://github.com/chloemrq/Project-Data-Management)

# I. Research question 
**How are changes in health and social protection expenditures associated with avoidable mortality across OECD countries over time?**

Population health differs significantly across countries. One key factor explaining these differences is the strength of social and health protection systems. In particular, public investment in healthcare and social protection is expected to reduce mortality from causes that are considered preventable or treatable through effective public policies.

This report seeks to understand the relationship between social and health protection spending and avoidable mortality, used as an indicator of the effectiveness of a country's health system. Avoidable mortality captures premature deaths (under age 75) that could be prevented through healthcare, making it a relevant proxy for population health.

There are two goals in our analysis. First, using panel data for 41 OECD countries between 2000 and 2023, this report aims to describe and analyse the global evolution of avoidable mortality across OECD countries and assess if high levels of social and health spending are correlated with lower avoidable mortality rates. Second, it focuses on the Covid-19 crisis, to understand if countries with a stronger health protection pre-Covid experienced lower avoidable mortality rates from 2019 to 2021.

## Method 
To conduct our study we will be using a **linear mixed model (LMM)**. Lagged variables will be used as investments in both the social and health systems likely impact the population's general health with a delay. Such a model will allow us to properly study the OECD countries taking into account their differences. 

For explanatory variables, in order to estimate the strength and quality of a country’s health protection scheme, we will use the following variables: 

* Health expenditure 
* Social expenditure aggregates
* Number of hospitals beds

We also have more general variables such as :

* GDP per capita 
* Unemployment rate 
* Human development index 
* Life expectancy

They will be used as control variables, since richer countries tend to have better living conditions which may lead to a generally healthier population, without the need for a strong health protection. 

Finally, the explained variable will be : 

* Avoidable mortality 

 
```{r}
# Loading the packages
library(here)
here::i_am("Project-Data-Management.Rproj")
```


```{r}
library(ggplot2)
library(dplyr)
library(tidyr)
library(vroom)
library(readxl)
library(lme4)
library(performance)
```

# II. Description of the datasets
This report relies on 8 datasets. Here is a short description of each of them. More details on the datasets and their descriptive statistics can be found in Phase 2.

#### Health expenditure - OECD (2025)
This dataset details the annual health expenditure and financing as a percentage of GDP for 52 countries (2000-2023). It includes consumption of healthcare goods and services from different health providers.

### Avoidable mortality - OECD (2025)
This dataset describes the number of "avoidable deaths" per 100,000 inhabitants annually for the period 2000-2023 for 46 countries. It contains 2 indicators referring to premature mortality (under age 75) : “preventable mortality” and “treatable mortality”. 

### GDP per Capita - World Bank (2024)
The GDP per capita dataset presents the GDP per capita (constant 2015 US$) from 1960 to 2023 for 70 countries.

### Hospital beds - OECD (2025)
This dataset provides data on the number of total hospitals beds by function of healthcare and by type of care (ie. somatic or psychiatric care) for the period 2000-2023 for 48 different countries.

### Life expectancy - World Bank (2023)
This dataset provides the life expectancy in years for women and men for a period ranging from 1960 to 2023, for 69 different countries or economies. 

### Social Expenditure Aggregate - OECD (2025)
This dataset includes statistics on public and private social expenditure at program level (e.g. Old age, Survivors, Incapacity-related benefits, Health, etc) as a percentage of GDP. It covers 38 OECD countries for the period 1980-2021/23.

### Unemployement Rate - IMF (2025)
This IMF dataset describes the percentage of the labor force that is unemployed and actively seeking employment. It is available from 1980 to 2025 and features 120 geographic regions. 

### HDI (Human Development Index) - UNDP (2025)
This dataset describes the human development index, per country (195), annually (1990-2023). It is a summary measure of average achievement in 3 dimensions of human development: a long and healthy life, being knowledgeable and having a decent standard of living.




```{r}
# Loading the cleaned dataset from phase 2
database <- vroom(here("data", "cleaned_database.csv"))
```


```{r}
# Loading the raw datasets to create a brief description table
health_expenditure <- vroom(here("data", "OECD.ELS.HD,DSD_SHA@DF_SHA,1.0+.A.EXP_HEALTH.PT_B1GQ._T.._T.._T....csv"))

avoidable_mortality <- vroom(here("data", "OECD.ELS.HD,DSD_HEALTH_STAT@DF_AM,1.1+.A.AVM.DT_10P5HB.._T........csv"))

gdp_per_capita <- vroom(
  here("data/API_NY.GDP.PCAP.KD_DS2_en_csv_v2_242568", "API_NY.GDP.PCAP.KD_DS2_en_csv_v2_242568.csv"),
  delim = ",",
  skip = 4,           # need to skip the first 4 rows
  col_names = TRUE,   
)

hospital_beds <- vroom(here("data", "OECD.ELS.HD,DSD_HEALTH_REAC_HOSP@DF_BEDS_FUNC,1.0+..BD..._T._T...csv"))

life_expectancy <- vroom(
  here("data/API_SP.DYN.LE00.IN_DS2_fr_csv_v2_11258", "API_SP.DYN.LE00.IN_DS2_fr_csv_v2_11258.csv"), 
  delim = ",",
  skip = 4,           # need to skip the first 4 rows
  col_names = TRUE)

social_expenditure <- vroom(here("data","OECD.ELS.SPD,DSD_SOCX_AGG@DF_SOCX_AGG,1.0PT_B1GQ.ES10._T.csv"))

unemployment <- vroom(here("data", "dataset_2025-11-21T14_31_58.442440069Z_DEFAULT_INTEGRATION_IMF.RES_WEO_9.0.0.csv"))

hdi <- read_excel("data/hdr-data.xlsx")
```


```{r}
# Description table 
data_sets <- list(
  list(name = "Health Expenditure", data = health_expenditure),
  list(name = "Avoidable Mortality", data = avoidable_mortality),
  list(name = "GDP per Capita", data = gdp_per_capita),
  list(name = "Number of Hospital Beds", data = hospital_beds),
  list(name = "Life Expectancy", data = life_expectancy),
  list(name = "Social Expenditure", data = social_expenditure),
  list(name = "Unemployement", data = unemployment),
  list(name = "HDI", data = hdi)
)

get_summary <- function(dataset) {
  data <- dataset$data
  dataset_name <- dataset$name

  data.frame(
    Dataset = dataset_name,
    Observations = nrow(data),
    Variables = ncol(data)
  )
}

# Apply to all datasets
summary_list <- lapply(data_sets, get_summary)
summary_table <- do.call(rbind, summary_list)

# Display the table
knitr::kable(summary_table, caption = "Brief summary of the datasets used in this report")
```

## Description of the merged and cleaned dataset 
```{r}
database |> 
  summarise("Number of rows" = n(), 
            "Number of columns" = ncol(database),
            "Percentage of NA" = paste0(round(sum(is.na(database)) / (n() * ncol(database)) * 100, 2), "%"),
            "Number of countries studied" = n_distinct(REF_AREA), 
            "Time period" = paste0(min(TIME_PERIOD), "-", max(TIME_PERIOD))) |> 
  as.data.frame() |>
  knitr::kable()
```


# 3. Data Analysis 
We first start by a visual exploration of our main variable : avoidable mortality (*OBS_VALUE_mortality*) and its link to explanatory variables.

### Evolution of avoidable mortality per country
```{r}
average_trend <- database |>
  group_by(TIME_PERIOD) |>
  summarise(mean_mortality = mean(OBS_VALUE_mortality, na.rm = TRUE))

database |>
  ggplot(aes(x = TIME_PERIOD, y = OBS_VALUE_mortality, color=REF_AREA)) +
  geom_line() +
  geom_line(
    data = average_trend,
    aes(x = TIME_PERIOD, y = mean_mortality, color="OECD average"),
    color = "red",
    linewidth = 1.3
  ) +
  scale_x_continuous(breaks = c(2000, 2010, 2020)) +
  labs(
    x = "Year",
    y = "Number of avoidable deaths",
    caption = "Red line: OECD average",
    title = "Avoidable mortality per country (2000-2023), per 100,000 inhabitants annually")
```
Most countries share the same downward sloping trend in avoidable mortality. A distinct increase appears in 2019, with a peak in 2020 and a decrease to previous trend values from 2021 in all countries. 
The country with the lowest avoidable death rate is Switzerland (CHE) and the highest is Latvia at the beginning of the 2000s, then surpassed by Lithuania (LTU) around 2007. Additionally, there is a strong increase in avoidable deaths from around 400 to almost 650 per 100,000 inhabitants in Mexico in 2019. 

It is important to note that this report primarily studies developed countries with the most available data from 2000 to 2023. We chose to exclude the following countries : South Africa (ZAF), Argentina (ARG), Peru (PER), Thailand (THA) and Brazil (BRA) as the data was not sufficient to proceed with proper data analysis. Thus, our conclusions will be biased due to the fact that we study more developed countries with, perhaps, more similar institutional structures and resistance to global health crises such as Covid-19. 

### Visualising *avoidable_mortality* against independent variables
The goal of our analysis is to determine if the evolution of health and social expenditures are correlated with the evolution of avoidable mortality. We can start the data analysis by simply plotting some independent variables against *avoidable_mortality* and observe the general trend. 

```{r}
ggplot(database, aes(x = OBS_VALUE_health_exp, y = OBS_VALUE_mortality)) +
  geom_point(aes(color = REF_AREA)) +
  theme(legend.position = "right") +
  labs(
    x = "Health expenditure (as % of GDP)", 
    y = "Avoidable mortality",
    title = "Avoidable mortality against Health expenditure") +
  geom_smooth(method = "lm", se = FALSE) 
```

As expected, as the level of health expenditure increases, avoidable mortality tends to decrease. Australia (AUS) detaches itself from other countries by having a particularly high level of health expenditure, but still a moderately high level of avoidable mortality. Most countries are situated on the left side of the graph (with low health expenditure) showcasing countries with high and low rates of avoidable mortality for the same level of health expenditure. 

```{r}
ggplot(database, aes(x = OBS_VALUE_social_expenditure, y = OBS_VALUE_mortality)) +
  geom_point(aes(color = REF_AREA)) +
  theme(legend.position = "none") +
  labs(
    x = "Social expenditure (as % of GDP)", 
    y = "Avoidable mortality",
    title = "Avoidable mortality against Social Expenditure") +
  geom_smooth(method = "lm", se = FALSE)
```

As social expenditure increases, the avoidable mortality rate decreases. Most countries' social expenditure is within 10% and 25% of their GDP. However, for these countries similar in social expenditure levels, avoidable mortality goes from 100 to almost 700 per 100,000 deaths, suggesting an important variability. This observation is consistent with the trend observed using the health expenditure variable. Fro similar levels of health or social expenditure, avoidable mortality seems to vary significantly between countries.


```{r}
ggplot(database, aes(x = OBS_VALUE_unemp, y = OBS_VALUE_mortality)) +
  geom_point(aes(color = REF_AREA)) +
  theme(legend.position = "none") +
  labs(    
    x = "Unemployement", 
    y = "Avoidable mortality",
    title = "Avoidable mortality against Unemployment") +
  geom_smooth(method = "lm", se = FALSE)
```
Here, the trend indicates that as unemployment increases, avoidable mortality does too. Most countries have low levels of unemployment and low rates of avoidable mortality. 
In the bottom right, Spain (ESP) and Greece (GRC) display very high rates of unemployment while keeping their avoidable mortality rates among the lowest of all countries. On the contrary, countries such as Mexico (MEX) in purple showcase high levels of avoidable mortality with very low rates of unemployment. 

```{r}
ggplot(database, aes(x = OBS_VALUE_gdp, y = OBS_VALUE_mortality)) +
  geom_point(aes(color = REF_AREA)) +
  theme(legend.position = "none") +
  labs(
    x = "GDP per Capita", 
    y = "Avoidable mortality",
    title = "Avoidable mortality against GDP per Capita") +
  geom_smooth(method = "lm", se = FALSE)
```
This graph suggests that as GDP per capita increases, the rate of avoidable mortality decreases. The avoidable mortality rate doesn't seem to go below 100 deaths per 100,000 inhabitants. Thus, as GDP per capita increases, avoidable mortality remains between 100 and 300 deaths per 100,000 inhabitants suggesting marginal change in mortality as a country's population becomes richer.


# 4. Econometric Analysis : Linear Mixed Model (LMM)

## Correlation matrix for control variables 
```{r}
control_vars <- database |>
  select(OBS_VALUE_mortality, OBS_VALUE_gdp, OBS_VALUE_hdi, OBS_VALUE_life_exp, OBS_VALUE_unemp)

cor(control_vars) |>
  knitr::kable()
```
The correlation matrix reveals strong linear relationships among several control variables. 

* Avoidable mortality is highly negatively correlated with life expectancy (-0.96), reflecting the fact that both variables capture very similar aspects of general population health. 
* Life expectancy is also strongly correlated with HDI (0.76) and GDP per capita (0.65), meaning there is an overlap between these variables. 

In order to avoid multicollinearity issues in our regression, we choose to exclude HDI and life expectancy from our control variables. We retain GDP per capita and unemployment, which can adjust for differences in economic development between countries and remain sufficiently distinct from avoidable mortality. 


## Creating lag operators/ lagged variables

```{r}
data_lagged <- database |>
  group_by(REF_AREA) |>
  arrange(TIME_PERIOD) |>
  mutate(
    mortality_lag1 = lag(OBS_VALUE_mortality, 1),
    
    healthExp_lag1 = lag(OBS_VALUE_health_exp, 1),
    
    healthExp_ma3 = (lag(OBS_VALUE_health_exp, 1) +
                     lag(OBS_VALUE_health_exp, 2) +
                     lag(OBS_VALUE_health_exp, 3)) / 3,
    
    healthExp_ma5 = (lag(OBS_VALUE_health_exp, 1) +
                     lag(OBS_VALUE_health_exp, 2) +
                     lag(OBS_VALUE_health_exp, 3) +
                     lag(OBS_VALUE_health_exp, 4) +
                     lag(OBS_VALUE_health_exp, 5)) / 5,
    
    hospBeds_lag1 = lag(OBS_VALUE_hosp_beds, 1),
    
    hospBeds_ma3 = (lag(OBS_VALUE_hosp_beds, 1) +
                     lag(OBS_VALUE_hosp_beds, 2) +
                     lag(OBS_VALUE_hosp_beds, 3)) / 3,
    
    hospBeds_ma5 = (lag(OBS_VALUE_hosp_beds, 1) +
                     lag(OBS_VALUE_hosp_beds, 2) +
                     lag(OBS_VALUE_hosp_beds, 3) +
                     lag(OBS_VALUE_hosp_beds, 4) +
                     lag(OBS_VALUE_hosp_beds, 5)) / 5,
    
    socialExp_lag1 = lag(OBS_VALUE_social_expenditure, 1),

    socialExp_ma3 = (lag(OBS_VALUE_social_expenditure, 1) +
                     lag(OBS_VALUE_social_expenditure, 2) +
                     lag(OBS_VALUE_social_expenditure, 3)) / 3, 
    
    socialExp_ma5 = (lag(OBS_VALUE_social_expenditure, 1) +
                     lag(OBS_VALUE_social_expenditure, 2) +
                     lag(OBS_VALUE_social_expenditure, 3) +
                     lag(OBS_VALUE_social_expenditure, 4) +
                     lag(OBS_VALUE_social_expenditure, 5)) / 5
  ) |>
  ungroup()
```

Before further modelling, we create lagged version of our variables. We believe that past investments in health sector and social protection have an impact on mortality. Using one-year lags will allow us to study short term effects such as changes in government budgets from one year to the next. 3-year and 5-year moving averages will also be used to capture long-term investment impacts. Indeed, we assume increased hospital capacities or training staff takes a few years before benefiting the health system. 

We will create lagged versions of 4 variables : mortality, health expenditure, social expenditure and hospital beds. 

Consequently we have : 

- `mortality_lag1` : 1-year lag of avoidable mortality 
- `healthExp_lag1` : 1-year lag of health expenditure (short-run)
- `healthExp_ma3` : 3-year average lag of health expenditure (medium-run)
- `healthExp_ma5` : 5-year average lag of health expenditure (long-run)
- `hospBeds_lag1` : 1-year lag of hospital beds 
- `hospBeds_ma3` : 3-year average lag of hospital beds
- `hospBeds_ma5` : 5-year average lag of hospital beds
- `socialExp_lag1` : 1-year lag of social expenditure
- `socialExp_ma3` : 3-year average lag of social expenditure
- `socialExp_ma5` : 5-year average lag of social expenditure


Additionally, to account for the Covid-19 shock, we introduce a `pandemic` dummy variable equal to 1 for the years 2020 to 2021 and 0 otherwise. We also add 2 interaction terms with Health expenditure and Social expenditure to assess the impact of these factors on avoidable mortality during this period.
```{r}
## Adding pandemic dummies
database <- database |>
  mutate(
    pandemic = ifelse(TIME_PERIOD %in% c(2020:2021), 1, 0)
  )

database <- database |>
  mutate(
    healthexp_pandemic = OBS_VALUE_health_exp * pandemic,
    socialexp_pandemic = OBS_VALUE_social_expenditure * pandemic
  )
```


## Model testing

### First test using multiple lags

We do a first test to see how our variables interact with each other, especially lags

The model we first want to test is : 

\begin{equation*}
\begin{aligned}
Mortality_{i,t} =\;& \gamma_{0,i}
+ \beta_{1} \, mortality_{i,t-1}
+ \beta_{2} \, health.expenditure_{i,t-1}
+ \beta_{3} \, health.expenditure_{i,t-[1,5]} \\[0.4em]
&+ \beta_{4} \, hospital.beds_{i,t-1}
+ \beta_{5} \, hospital.beds_{i,t-[1,5]} 
+ \beta_{6} \, social.expenditure_{i,t-1} \\[0.4em]
&+ \beta_{7} \, social.expenditure_{i,t-[1,5]}
+\beta_{8} \, GDP.per.capita_{i,t}
+ \beta_{9} \, Unemployment_{i,t} \\[0.4em]
\end{aligned}
\end{equation*}



With

- i = index for country i 
- t = index for period t (here our periods are years)



We also assume that mortality (at time t-1), social expenditure and hospital beds, our explanatory variables, are fixed effects.
GDP per capita and Unemployment, our control variables, are random effects (meaning that we take into account in this model the fact that they will be different for each country).


- Fixed effects have their coefficient represented by the symbol beta
- Random effects have their coefficient represented by the symbol gamma

All explanatory variables enter the model as fixed effects, while country-specific heterogeneity is captured through a random intercept.


```{r}
first_test <- lmer(OBS_VALUE_mortality ~ mortality_lag1 + healthExp_lag1 + healthExp_ma5 + hospBeds_lag1 + hospBeds_ma5 + socialExp_lag1 + socialExp_ma5 + OBS_VALUE_gdp + OBS_VALUE_unemp + (1 | REF_AREA), 
                   control = lmerControl(autoscale = TRUE), # added after R warned some variables are on different scales 
                   data = data_lagged, 
                   REML = FALSE)
print(summary(first_test), correlation = TRUE)
```
After this first test, we notice multiple problems : 

- The correlation between `mortality_lag1` and the intercept is too high, nullifying the effect of the random intercept which ends up having a variance and a standard deviation of 0. We will remove mortality_lag1 from the next regressions to avoid such a result.
- Using both the first lag and the long-run moving average of variables in the same model is not possible. The correlation between the two makes it hard to distinguish which has an effect on mortality and the long-run moving average of explanatory variables end up having incoherent coefficients. 

Therefore we will compare short-run, medium-run and long-run in 3 different models 



### Models for the short-run, medium-run and long-run


*Short-run model :* 

\begin{equation*}
\begin{aligned}
Mortality_{i,t} =\;& \gamma_{0,i}
+ \beta_{1} \, health.expenditure_{i,t-1}
+ \beta_{2} \, hospital.beds_{i,t-1}
+ \beta_{3} \, social.expenditure_{i,t-1} \\[0.4em]
&+\beta_{4} \, GDP.per.capita_{i,t}
+ \beta_{5} \, Unemployment_{i,t}
\end{aligned}
\end{equation*}



```{r}
model_short_run <- lmer(OBS_VALUE_mortality ~ healthExp_lag1 + hospBeds_lag1 + socialExp_lag1 + OBS_VALUE_gdp + OBS_VALUE_unemp + (1 | REF_AREA), 
                   control = lmerControl(autoscale = TRUE),
                   data = data_lagged, 
                   REML = FALSE)
summary(model_short_run)
```



*Medium-run model : *

\begin{equation*}
\begin{aligned}
Mortality_{i,t} =\;& \gamma_{0,i}
+ \beta_{1} \, health.expenditure_{i,t-[1,3]}
+ \beta_{2} \, hospital.beds_{i,t-[1,3]}
+ \beta_{3} \, social.expenditure_{i,t-[1,3]} \\[0.4em]
&+\beta_{4} \, GDP.per.capita_{i,t}
+ \beta_{5} \, Unemployment_{i,t}
\end{aligned}
\end{equation*}

```{r}
model_medium_run <- lmer(OBS_VALUE_mortality ~ healthExp_ma3 + hospBeds_ma3 + socialExp_ma3 + OBS_VALUE_gdp + OBS_VALUE_unemp + (1 | REF_AREA), 
                   control = lmerControl(autoscale = TRUE),
                   data = data_lagged, 
                   REML = FALSE)
summary(model_medium_run)
```



*Long-run model : *

\begin{equation*}
\begin{aligned}
Mortality_{i,t} =\;& \gamma_{0,i}
+ \beta_{1} \, health.expenditure_{i,t-[1,5]}
+ \beta_{2} \, hospital.beds_{i,t-[1,5]}
+ \beta_{3} \, social.expenditure_{i,t-[1,5]} \\[0.4em]
&+\beta_{4} \, GDP.per.capita_{i,t}
+ \beta_{5} \, Unemployment_{i,t}
\end{aligned}
\end{equation*}

```{r}
model_long_run <- lmer(OBS_VALUE_mortality ~ healthExp_ma5 + hospBeds_ma5 + socialExp_ma5 + OBS_VALUE_gdp + OBS_VALUE_unemp + (1 | REF_AREA), 
                   control = lmerControl(autoscale = TRUE), 
                   data = data_lagged, 
                   REML = FALSE)
summary(model_long_run)
```

All three models seem interesting to analyse as they show the different impacts social expenditure and health expenditure can have on mortality. 
The first thing we notice is that in all 3 models health expenditure, social expenditure and the number of hospital beds are significant, they have a t value superior to 1 in absolute value. It means that whether it is in the short, medium or long-run they can impact the level of mortality. 

In the short-run (represented by variables with the suffix `_lag1`) we can interpret the impact of health and social expenditure on avoidable mortality as an immediate budgetary effect. Having a new monetary flow each year in the health sector, or for households in general is important to face urgent needs or crisis.
In the medium-run (represented by variables with the suffix `_ma3`), health expenditure, social expenditure and hospital beds are no longer there to cover an urgent need but are an investment. Government invest with certain policies in mind in order to reduce mortality and to improve welfare in the country in general. There is a cumulative effect, meaning that thanks to the money invested throughout the years, policies were able to show their efficiency afterwards.
In the long-run (represented by variables with the suffix `_ma5`), the impact of health expenditure, social expenditure and the number of hospital beds can be interpreted as a structural effect. Some countries have an history of public intervention, especially through health and social expenditure. These structural differences can sometimes make a difference in how easy or hard it will be for a country to reduce their avoidable mortality. It can influence the efficiency of policies pursued through health and social expenditure. 




### Comparing short-run, medium run and long-run

*Looking at the R² :*

The first results are for the short-run model, the second for the medium-run, and the third for the short-run
```{r}
r2(model_short_run)
r2(model_medium_run)
r2(model_long_run)

```

R² - also called the coefficient of determination - is a measure of how well the explanatory variables of a model explain the observed variable. In a linear mixed model R² is divided in two parts : the conditional R² for random effect which shows how structural differences explain the observed variable, and the marginal R² for fixed effect which shows how other fixed variables explain the observed variable. 
When R² is close to one it means that the observed variable is well explained by the chosen explanatory variables, otherwise not so much. 

Here we can see that no matter the model (short, medium or long-run), R² has more or less the same value meaning that none of the model is strictly "better than the other", they simply explain different notions. 
Moreover while conditional R² always have a high value (~0.8) it is not the case for marginal R². This can be explained by the fact that avoidable mortality highly varies from a country to another and that there are a lot of structural differences (the country's history and specific aspects). For example in a country the amount of avoidable deaths for a certain year is highly linked to that of the previous year. 






*Looking at the AIC : *

- For the short-run model : 8065.7
- For the medium-run model : 7086.9
- For the long-run model : 6185.0

The AIC - Akaike information criterion - is a measure for how well fitted a model is. The AIC verifies both if explanatory variables explain the observed variable correctly and if the number of parameters in the model is too high. Having a high number of parameters to make the model "fit better" is a negative thing as it lowers chances of the model working well outside the sample.  

Generally the lower the AIC is, the better the model is.
We notice that the short-run model has the highest while the long-run model has the lowest AIC.
Considering all 3 models have the same number of parameters, a lower AIC means avoidable mortality is better explained by the long-run model and then medium-run one. 
More specifically it means that avoidable mortality is better explained by long-term investments than short-term influx of expenditures. This conclusion matches our initial intuition :  Avoidable mortality can be impacted by sustained investments. 



### Testing for the Covid-19 period

Regressions using our dummy variable for the Covid-19 and interaction terms, to see the impact of investment in health on avoidable mortality during the pandemic.

Using interaction terms for time t (current period) could lead to reverse causality problems. We might be unable to identify whether health expenditure, social expenditure and hospital beds impacted avoidable mortality or if because mortality increased suddenly during the pandemic, health expenditure, social expenditure and hospital beds were increased afterwards. 

```{r}
model_covid_time_t <- lmer(OBS_VALUE_mortality ~ OBS_VALUE_hosp_beds + OBS_VALUE_health_exp + OBS_VALUE_social_expenditure + pandemic + healthexp_pandemic + socialexp_pandemic + OBS_VALUE_gdp + OBS_VALUE_unemp + (1 | REF_AREA), 
                   control = lmerControl(autoscale = TRUE), 
                   data = database, 
                   REML = FALSE)
summary(model_covid_time_t)
```

Then we want to see the impact of previous investments using our lags 

As a result, in order to clearly see the impact of previous investment on avoidable mortality during the Covid-19 crisis, we create interaction variables using our lags. 
```{r}
data_lagged <- data_lagged |>
  mutate(
    pandemic = ifelse(TIME_PERIOD %in% c(2020:2021), 1, 0)
  )

data_lagged <- data_lagged |>
  mutate(
    healthexp_pandemic_lag1 = healthExp_lag1 * pandemic,
    healthexp_pandemic_ma3 = healthExp_ma3 * pandemic,
    healthexp_pandemic_ma5 = healthExp_ma5 * pandemic,
    socialexp_pandemic_lag1 = socialExp_lag1 * pandemic,
    socialexp_pandemic_ma3 = socialExp_ma3 * pandemic,
    socialexp_pandemic_ma5 = socialExp_ma5 * pandemic
  )
```

- `healthexp_pandemic_lag1` = interaction term between the `pandemic` dummy variable and `healthExp_lag1`
- `healthexp_pandemic_ma3` = interaction term between the `pandemic` dummy variable and `healthExp_ma3`
- `healthexp_pandemic_ma5` = interaction term between the `pandemic` dummy variable and `healthExp_ma5`
- `socialexp_pandemic_lag1` = interaction term between the `pandemic` dummy variable and `socialExp_lag1`
- `socialexp_pandemic_ma3` = interaction term between the `pandemic` dummy variable and `socialExp_ma3`
- `socialexp_pandemic_ma5` = interaction term between the `pandemic` dummy variable and `socialExp_ma5`


The interaction coefficient measures whether the association between pre-existing investment and mortality differed during the pandemic period relative to normal years.



*In the short-run :* 

\begin{equation*}
\begin{aligned}
Mortality_{i,t} =\;& \gamma_{0,i}
+ \beta_{1} \, health.expenditure_{i,t-1}
+ \beta_{2} \, hospital.beds_{i,t-1}
+ \beta_{3} \, social.expenditure_{i,t-1} \\[0.4em]
&+ \beta_{4} \, pandemic
+ \beta_{5} \, hospital.beds_{i,t-1} * pandemic
+ \beta_{6} \, social.expenditure_{i,t-1} * pandemic \\[0.4em]
&+ \beta_{7} \, GDP.per.capita_{i,t} 
+ \beta_{8} \, Unemployment_{i,t}
\end{aligned}
\end{equation*}

```{r}
model_covid_short_run <- lmer(OBS_VALUE_mortality ~ hospBeds_lag1 + healthExp_lag1 + socialExp_lag1 + pandemic + healthexp_pandemic_lag1 + socialexp_pandemic_lag1 + OBS_VALUE_gdp + OBS_VALUE_unemp + (1 | REF_AREA), 
                   control = lmerControl(autoscale = TRUE), 
                   data = data_lagged, 
                   REML = FALSE)
summary(model_covid_short_run)
```

In order to interpret our results we need to sum the coefficient obtained for the health expenditure variable (`healthExp_lag1`) and the interaction term `healthexp_pandemic_lag1`. Same thing for the social expenditure variable. This will tell us how the pandemic impacts the effect of health expenditure and social expenditure on avoidable mortality. 

```{r}
s <- fixef(model_covid_short_run)

# Health expenditure during Covid
s["healthExp_lag1"] + s["healthexp_pandemic_lag1"]

# Social expenditure during Covid
s["socialExp_lag1"] + s["socialexp_pandemic_lag1"]
```
For health expenditure, we notice that the coefficient goes from a value of -12.46 outside of the pandemic compared to -6.67 during Covid. While health expenditure continues to lower avoidable mortality, its effect during the pandemic is halved. Such a result is logical considering the needs of the health sector during this period and the high number of deaths. 

Then for social expenditure, it seems like its effect is doubled during the pandemic since we go from -4.237 to -8.767. We can interpret this as the idea that social protection was even more essential during this crisis since households faced many difficulties. For example, social protection helped counter the risk of diseases and poverty.



*In the medium-run :*

\begin{equation*}
\begin{aligned}
Mortality_{i,t} =\;& \gamma_{0,i}
+ \beta_{1} \, health.expenditure_{i,t-[1,3]}
+ \beta_{2} \, hospital.beds_{i,t-[1,3]}
+ \beta_{3} \, social.expenditure_{i,t-[1,3]} \\[0.4em]
&+ \beta_{4} \, pandemic
+ \beta_{5} \, hospital.beds_{i,t-[1,3]} * pandemic
+ \beta_{6} \, social.expenditure_{i,t-[1,3]} * pandemic \\[0.4em]
&+ \beta_{7} \, GDP.per.capita_{i,t} 
+ \beta_{8} \, Unemployment_{i,t}
\end{aligned}
\end{equation*}


```{r}
model_covid_medium_run <- lmer(OBS_VALUE_mortality ~ hospBeds_ma3 + healthExp_ma3 + socialExp_ma3 + pandemic + healthexp_pandemic_ma3 + socialexp_pandemic_ma3 + OBS_VALUE_gdp + OBS_VALUE_unemp + (1 | REF_AREA), 
                   control = lmerControl(autoscale = TRUE), 
                   data = data_lagged, 
                   REML = FALSE)
summary(model_covid_medium_run)
```
Here, if we sum coefficients and interaction terms we have : 
```{r}
m <- fixef(model_covid_medium_run)

# Health expenditure
m["healthExp_ma3"] + m["healthexp_pandemic_ma3"]

# Social expenditure
m["socialExp_ma3"] + m["socialexp_pandemic_ma3"]
```
We notice that this model seems to have the same trends as the short-run model.

Health expenditure has a lower impact during covid (-7.146) than outside of this period (-10.87)  Despite these results it is worth mentioning that the decrease is lower than what was observed in the previous model. We can infer that it is because long term investments and policies offer a better protection during crisis. A country with stronger health policies would have suffered less of the effects of Covid-19. 

Social expenditure has a higher impact during Covid (-11.435 against -6.074). Just like in the short-run model, the effect of social expenditure almost doubles during the pandemic.


*In the long-run : *

\begin{equation*}
\begin{aligned}
Mortality_{i,t} =\;& \gamma_{0,i}
+ \beta_{1} \, health.expenditure_{i,t-[1,5]}
+ \beta_{2} \, hospital.beds_{i,t-[1,5]}
+ \beta_{3} \, social.expenditure_{i,t-[1,5]} \\[0.4em]
&+ \beta_{4} \, pandemic
+ \beta_{5} \, hospital.beds_{i,t-[1,5]} * pandemic
+ \beta_{6} \, social.expenditure_{i,t-[1,5]} * pandemic \\[0.4em]
&+ \beta_{7} \, GDP.per.capita_{i,t} 
+ \beta_{8} \, Unemployment_{i,t}
\end{aligned}
\end{equation*}

```{r}
model_covid_long_run <- lmer(OBS_VALUE_mortality ~ hospBeds_ma5 + healthExp_ma5 + socialExp_ma5 + pandemic + healthexp_pandemic_ma5 + socialexp_pandemic_ma5 + OBS_VALUE_gdp + OBS_VALUE_unemp + (1 | REF_AREA), 
                   control = lmerControl(autoscale = TRUE), 
                   data = data_lagged, 
                   REML = FALSE)
summary(model_covid_long_run)
```

Then, if we sum coefficients and interaction terms we have : 
```{r}
l <- fixef(model_covid_long_run)

# Health expenditure
l["healthExp_ma5"] + l["healthexp_pandemic_ma5"]

# Social expenditure
l["socialExp_ma5"] + l["socialexp_pandemic_ma5"]
```
The same trend as before is noticed here. 

For health expenditure the value of the combined coefficients (-7.134) is lower than when outside of the pandemic (-10.15). Similarly to the medium-run model, the decrease of the impact of health expenditure during Covid is less strong than it was in the short-run model. This, once again, indicates the benefits of a strong long term investment in health.

For social expenditure the value of the combined coefficients is higher (-11.35) than the coefficient alone, outside of the pandemic (-6.366). The same logic as in previous models can be applied.



### Chosen main model 

Considering our question, the most interesting results for us to analyse are the medium-run results. It is the most appropriate choice since we are trying to grasp how adopting a health or social policy (and therefore investing in health) can help a country reduce their avoidable mortality. 

\begin{equation*}
\begin{aligned}
Mortality_{i,t} =\;& \gamma_{0,i}
+ \beta_{1} \, health.expenditure_{i,t-[1,3]}
+ \beta_{2} \, hospital.beds_{i,t-[1,3]}
+ \beta_{3} \, social.expenditure_{i,t-[1,3]} \\[0.4em]
&+\beta_{4} \, GDP.per.capita_{i,t}
+ \beta_{5} \, Unemployment_{i,t}
\end{aligned}
\end{equation*}



## Main model analysis





# 5. Conclusion 