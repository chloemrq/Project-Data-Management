---
title: "Phase3"
author: "Karla Otoude and Chloé Marquis"
format: pdf
execute:
  echo: false
---

# Link to our github project 
[Our Github Project](https://github.com/chloemrq/Project-Data-Management)

# I. Research question 
**How does the level of social protection impact the general population health ?** 

We want to identify if a stronger social and health protection (quantified by different variables such as health expenditure, tax revenues, etc) has an impact on the avoidable mortality rate. In order to do so we will analyse data collected in OECD countries from 2000 to 2023. 

There are two goals in our analysis :
The first is to understand the global evolution of the data and the reasons behind its trends.
The second is to study the Covid-19 crisis. We believe it revealed how necessary having a proper social protection is to limit the number of deaths during a pandemic. 


# Method 
To conduct our study we will be using a **linear mixed model (LMM)** with lags. Such a model will allow us to properly study the OECD countries taking into account their differences. It also a fitting model since we are working with time-based data. 

Considering our research question, we will use multiple datasets and variables.

For explanatory variables, in order to estimate the strength and quality of a country’s health protection scheme, we will have : 
- Health expenditure 
- Social expenditure aggregates
- Number of hospitals beds 

We also have more general variables such as :
- GDP per capita 
- Unemployment rate 
- Human development index 
- Life expectancy
They will be used as control variables, since richer countries tend to have better living conditions which may lead to a generally healthier population, without the need for a strong health protection. 

Finally, the explained variable will be : 
- Avoidable mortality 
It will be used to estimate the population’s general health. 

 
```{r}
# Loading the packages
#| message: false
library(here)
here::i_am("Project-Data-Management.Rproj")
```


```{r}
#| message: false
library(ggplot2)
library(dplyr)
library(tidyr)
library(vroom)
library(readxl)
```

# II. Description of the datasets
This report relies on 8 datasets. Here is a short description of each of them. More details on the datasets and their descriptive statistics can be found in Phase 2.

#### Health expenditure - OECD (2025)
This dataset details the annual health expenditure and financing as a percentage of GDP for 52 countries. The data is available for a period ranging from 2000 to 2024. It was computed using financial flows related to the consumption of healthcare goods and services from different health providers such as Hospitals or Residential long-term care facilities.  

### Avoidable mortality - OECD (2025)
This dataset describes the number of "avoidable deaths" per 100000 inhabitants annually for the period 2000-2024 for 46 countries. It contains contains both “preventable mortality” and “treatable (or amenable) mortality”. The first refers to deaths that can be avoided through effective public health and primary prevention interventions. The second refers to timely and effective health care interventions, including prevention and treatment.Both indicators refer to premature mortality (under age 75).

### GDP per Capita - World Bank (2024)
The GDP per Capita dataset presents the GDP per capita (constant 2015 US$) from 1960 to 2024 for 70 countries. This indicator is expressed in constant prices, meaning the series has been adjusted to account for price changes over time. The reference year for this adjustment is 2015. This indicator is expressed in United States dollars. 

### Hospital beds - OECD (2025)
This dataset provides data on the number of total hospitals beds by function of healthcare and by type of care (ie. somatic or psychiatric care) for the period 2000-2024 for 48 different countries. Total hospital beds are the sum of the following categories:
Curative care (acute care) beds in hospitals, Rehabilitative care beds in hospitals, Long-term care beds in hospitals, All other beds in hospitals not elsewhere classified. 

### Life expectancy - World Bank (2023)
This dataset provides the life expectancy in years for women and men for a period ranging from 1960 to 2023, for 69 different countries or economies. 

### Social Expenditure Aggregate - OECD (2025)
This dataset includes internationally comparable statistics on public and mandatory and voluntary private social expenditure at programme level (e.g. Old age, Survivors, Incapacity-related benefits, Health, etc) It covers 38 OECD countries and some accession countries for the period 1980-2021/23 and estimates for aggregates for 2022-24.

### Unemployement Rate - IMF (2025)
This IMF dataset describes the percentage of the labor force that is unemployed and actively seeking employment. It is available from 1980 to 2025 and features 120 geographic regions. 

### HDI (Human Development Index) - UNDP ()
This dataset describes the human development index, per country (195), annually (1990-2023). It is a summary measure of average achievement in key dimensions of human development: a long and healthy life, being knowledgeable and having a decent standard of living. The HDI is between 0 (low human development) and 1 (very high human development).




```{r}
# Loading the cleaned dataset from phase 2
#| message: false
#| warning: false
database <- vroom(here("data", "cleaned_database.csv"))
```


```{r}
# Loading the raw datasets to create a brief description table
#| message: false
#| warning: false
health_expenditure <- vroom(here("data", "OECD.ELS.HD,DSD_SHA@DF_SHA,1.0+.A.EXP_HEALTH.PT_B1GQ._T.._T.._T....csv"))

avoidable_mortality <- vroom(here("data", "OECD.ELS.HD,DSD_HEALTH_STAT@DF_AM,1.1+.A.AVM.DT_10P5HB.._T........csv"))

gdp_per_capita <- vroom(
  here("data/API_NY.GDP.PCAP.KD_DS2_en_csv_v2_242568", "API_NY.GDP.PCAP.KD_DS2_en_csv_v2_242568.csv"),
  delim = ",",
  skip = 4,           # need to skip the first 4 rows
  col_names = TRUE,   
)

hospital_beds <- vroom(here("data", "OECD.ELS.HD,DSD_HEALTH_REAC_HOSP@DF_BEDS_FUNC,1.0+..BD..._T._T...csv"))

life_expectancy <- vroom(
  here("data/API_SP.DYN.LE00.IN_DS2_fr_csv_v2_11258", "API_SP.DYN.LE00.IN_DS2_fr_csv_v2_11258.csv"), 
  delim = ",",
  skip = 4,           # need to skip the first 4 rows
  col_names = TRUE)

social_expenditure <- vroom(here("data","OECD.ELS.SPD,DSD_SOCX_AGG@DF_SOCX_AGG,1.0PT_B1GQ.ES10._T.csv"))

unemployment <- vroom(here("data", "dataset_2025-11-21T14_31_58.442440069Z_DEFAULT_INTEGRATION_IMF.RES_WEO_9.0.0.csv"))

hdi <- read_excel("data/hdr-data.xlsx")
```


# Description table 
```{r}
#| message: false
#| warning: false
data_sets <- list(
  list(name = "Health Expenditure", data = health_expenditure),
  list(name = "Avoidable Mortality", data = avoidable_mortality),
  list(name = "GDP per Capita", data = gdp_per_capita),
  list(name = "Number of Hospital Beds", data = hospital_beds),
  list(name = "Life Expectancy", data = life_expectancy),
  list(name = "Social Expenditure", data = social_expenditure),
  list(name = "Unemployement", data = unemployment),
  list(name = "HDI", data = hdi)
)

get_summary <- function(dataset) {
  data <- dataset$data
  dataset_name <- dataset$name

  data.frame(
    Dataset = dataset_name,
    Observations = nrow(data),
    Variables = ncol(data)
  )
}

# Apply to all datasets
summary_list <- lapply(data_sets, get_summary)
summary_table <- do.call(rbind, summary_list)

# Display the table
knitr::kable(summary_table, caption = "Brief summary of the datasets used in this report")
```







